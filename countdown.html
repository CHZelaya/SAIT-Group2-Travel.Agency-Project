<!-- 
Author: Stephen Garo
Date: 2024-09-30
Course Module: Web Application Development (CPRG-210-A)
Assignment: Individual Project 1 - Travel Website
-->

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Countdown Page</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link rel="stylesheet" href="style.css">
    <script>
       
        // Declaring variables and setting timer 7 seconds or 7000 milliseconds
        let countdown;
        let remainingTime = 7; // Countdown time from 7 seconds

        // This function is activated when the window is finish loading
        window.onload = function() {
        // Sets timer, eventually replaces text in h1 tag and updates countdown every second until remaining time is 0, then window closes
            countdown = setInterval(() => {
                remainingTime--;
                document.querySelector('h1').innerText = `This page will close...in ${remainingTime} seconds`;   

                if (remainingTime <= 0) {
                    clearInterval(countdown);
                    window.close(); // Closes the countdown.html page after 7 seconds
                }
            }, 1000);
        };

        // Redirect if the user clicks the link in the div element below
        function handleClick() {
            clearInterval(countdown); // Ignores and clears the countdown to redirect
            redirectToUrl(); 
        }

        // This function redirects if there is a URL and an opener window (parent window) as conditions and then closes the countdown window and continues to direct
        function redirectToUrl() {
            if (window.opener && window.opener.targetUrl) {
                window.opener.location.href = window.opener.targetUrl; // Redirect the opener window to the stored URL
                window.close();
            }
        }

    </script>
</head>
<body>
    <div class="container text-center mt-5">
        <h1>This page will close...in 7 seconds</h1>
        <p>If you want to know more about the country you clicked, click below:</p>
        <a href="#" onclick="handleClick()" class="btn btn-primary">Country's Official Tourist Website</a>
    </div>
</body>
</html>
